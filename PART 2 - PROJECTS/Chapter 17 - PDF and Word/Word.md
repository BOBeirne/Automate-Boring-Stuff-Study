# Word Documents

- Word documents have `.docx` extension
- **Much more complex** than plaintext, word documents have **3 different data types**:
  - `Document object` - Represents the entire document
  - List of `Paragraph object`s - Represents the paragraphs in the document, each **paragraph begins after** user presses `ENTER` or `RETURN` while typing word document
  - 1+ `Run object`s - Each run object represents a contiguous segment of text within a document that shares the exact same formatting properties

## Run object

- `run object` represents a contiguous segment of text within a document that shares the exact same formatting properties.

```text
A plain paragraph with some **bold** and some *italic*
		Run 1	    		 Run 2	    Run 3	Run 4
```

| Run Object | Text Segment                  | Formatting/Properties                  |
| :--------- | :---------------------------- | :------------------------------------- |
| Run 1      | "A plain paragraph with some" | Normal/Plain text (No special styling) |
| Run 2      | "bold"                        | **Bold** styling applied               |
| Run 3      | "and some"                    | Normal/Plain text (No special styling) |
| Run 4      | "italic"                      | *Italic* styling applied               |

## Python-docx

- You can use `python-docx` library to read and write word documents
- **Requirements WARNING!!!** To install using pip, run `pip install python-docx` NOT `Docx`, Docx is a different Package

## Reading Word Documents

- We will be using `demo.docx` from exercise files

```python
import docx

doc = docx.Document('demo.docx') #create a document object
len(doc.paragraphs) # count how many paragraphs are in the whole document
# 7
doc.paragraphs[0].text # get the text of the first paragraph
# 'Document Title'
doc.paragraphs[1].text # get the text of the second paragraph
# 'A plain paragraph with some bold text and some italic'
len(doc.paragraphs[1].runs) # check how many runs are in the second paragraph
# 4
doc.paragraphs[1].runs[0].text # get the text of the first run in the second paragraph
# 'A plain paragraph with some '
doc.paragraphs[1].runs[1].text # get the text of the second run in the second paragraph
# 'bold'
doc.paragraphs[1].runs[2].text
# ' text and some '
doc.paragraphs[1].runs[3].text
# 'italic'
```

#### get_text()

- if you only care about text contents of the document, you can use `get_text() function` to get text only
- It accepts a `filename.docx` and returns a single `string value` of all it's text

```python
import docx

def get_text(filename): # use the function call
	doc = docx.Document(filename) # pass the filename name in cwd
	full_text = [] # initiate empty list for the full text string
	for paragraph in doc.paragraphs: # loop over paragraphs
		full_text.append(paragraph.text) # add each paragraph to the list
	return '\n'.join(full_text) # return full text with each paragraph in new line

print(get_text('demo.docx')) # get the contents printed out for demo document
```

- you can also **import the above snippet of code as a separate module** (see `readDocx.py`)

```python
import readDocx
print(redDocx.get_text(demo.docx)) #  essentially the same as calling the function
```

- You can **adjust the text before printing** it out in a few ways: 
  - `full_text.append('  ' + para.text)` # add **2 spaces before** each paragraph
  - `return '\n\n'.join(full_text)` # add **double space between** paragraphs

### Styling Paragraph and Run Objects

- You can **change the style of the text** in the `.docx` file by **creating** a `style` **object**
- There are **3 types of styles:**
  - `Paragraph style`
  - `Character style`
  - `Linked style` (apply to **both objects at once**)
- to **change** the current **style** of **whole document** you can simply **assign it to all paragraphs**
- If style is set to `None`, **no style will be associated** with the `Paragraph` or `Run` object


#### General Text Styles

| Style Name        | Description                            | Style Name      | Description                        |
| :---------------- | :------------------------------------- | :-------------- | :--------------------------------- |
| **Normal**        | Default body text.                     | **Body Text**   | Standard paragraph style.          |
| **Body Text 2**   | Secondary body text style.             | **Body Text 3** | Tertiary body text style.          |
| **Caption**       | Used for figure or table descriptions. | **MacroText**   | Text generated by a macro.         |
| **No Spacing**    | Text with minimal line spacing.        | **Quote**       | Blockquote style.                  |
| **Intense Quote** | Highlighted blockquote style.          | **Subtitle**    | Document subtitle.                 |
| **Title**         | Document main title.                   | **TOC Heading** | Heading for the table of contents. |

#### Document Heading Styles

These styles define the hierarchical structure of the document.

* **Heading 1:** Top-level section title.
* **Heading 2:** Major subsection title.
* **Heading 3:** Minor subsection title.
* **Heading 4:** Fourth-level heading.
* **Heading 5:** Fifth-level heading.
* **Heading 6:** Sixth-level heading.
* **Heading 7:** Seventh-level heading.
* **Heading 8:** Eighth-level heading.
* **Heading 9:** Ninth-level heading.

#### List Formatting Styles

These styles are used to format various types of lists, including bulleted and numbered formats.

* **List Styles:**
    * **List**
    * **List 2**
    * **List 3**
* **Bullet Point Styles:**
    * **List Bullet**
    * **List Bullet 2**
    * **List Bullet 3**
* **List Paragraph Styles:**
    * **List Paragraph** (Used for introductory list text.)
* **Numbered List Styles:**
    * **List Number**
    * **List Number 2**
    * **List Number 3**
* **List Continuation Styles:**
    * **List Continue**
    * **List Continue 2**
    * **List Continue 3**


- When using a **linked style for a `Run object`**, you’ll need to **add ' Char' to the end of its name**. 
- Example of how to set the `Quote linked style`:
  - for a `Paragraph object`, you would use `paragraphObj.style = 'Quote'` 
  - for a `Run object`, you would use `runObj.style = 'Quote Char'`

### Run Attributes

- use `text attributes` to **style runs**
- Each attribute can be set to one of 3 values:
  - `True` - always enabled, regardless of what other styles are applied
  - `False` - always disabled
  - `none` - default's to whatever run's style is applied to it

Common Text Formatting

| Tag Name           | Effect                                                                          | Markdown/HTML Equivalent                   |
| :----------------- | :------------------------------------------------------------------------------ | :----------------------------------------- |
| **bold**           | The text appears in bold.                                                       | `**text**` or `__text__`                   |
| **italic**         | The text appears in italic.                                                     | `*text*` or `_text_`                       |
| **underline**      | The text is underlined.                                                         | `<u>text</u>` (HTML)                       |
| **strike**         | The text appears with a strikethrough.                                          | `~~text~~`                                 |
| **double\_strike** | The text appears with a double strikethrough.                                   | Not standard Markdown                      |
| **all\_caps**      | The text appears in capital letters.                                            | CSS `text-transform: uppercase`            |
| **small\_caps**    | The text appears in capital letters, with lowercase letters two points smaller. | CSS `font-variant: small-caps`             |
| **shadow**         | The text appears with a shadow.                                                 | CSS `text-shadow`                          |
| **outline**        | The text appears outlined rather than solid.                                    | CSS `text-stroke` or `text-shadow`         |
| **rtl**            | The text is written right-to-left.                                              | CSS `direction: rtl` or `dir="rtl"` (HTML) |
| **imprint**        | The text appears pressed into the page.                                         | Not standard                               |
| **emboss**         | The text appears raised off the page in relief.                                 | Not standard                               |

Example exercise:
- Change styles of `demo.docx`

```python
import docx

doc = docx.Document('demo.docx')
""" 1st paragraph """
doc.paragraphs[0].text # get the text of the first paragraph
# ' 1st paragraph '
doc.paragraphs[0].style # get the style of the first paragraph
#_ParagraphStyle('Title') id: 2035613463424
doc.paragraphs[0].style = 'Normal' # lets change it to normal

""" 2nd paragraph """
doc.paragraphs[1].text # get text of the second paragraph
# 'A plain paragraph with some bold text and some italic'
(doc.paragraphs[1].runs[0].text, doc.paragraphs[1].runs[1].text, doc.paragraphs[1].runs[2].text, doc.paragraphs[1].runs[3].text) # get all runs in the 2nd paragraph, one by one
# ('A plain paragraph with some ', 'bold', ' and some ', 'italic')
doc.paragraphs[1].runs[0].style = 'Quote Char' # set the style of the first run in the 2nd paragraph to quote style
doc.paragraphs[1].runs[1].underline = True # set the 2nd run to have underline
doc.paragraphs[1].runs[3].underline = True # set the 4th run to have underline also

doc.save('restyled.docx') # save a modified copy under a new name
```

## docx.Document() for new document

- You can create a new, **blank word document object** using `docx.Document()`
- to create a new paragraph, use `add_paragraph()` and pass it text contents
- To add text to the end of an existing paragraph, call the paragraph’s add_run() method and pass it a string of text you want added

```python
import docx
""" Creating a blank document and adding a paragraph """
doc = docx.Document()
doc.add_paragraph('Hello, world') # add a new paragraph to the document
doc.save('helloworld.docx') # save the document

""" Adding multiple paragraphs to a document """
para_obj_1 = doc.add_paragraph('This is a second paragraph.') # add a 2nd paragraph to the document
para_obj_2 = doc.add_paragraph('This is a yet another paragraph.') # add a 3rd paragraph

""" append text to 2nd paragraph """
para_obj_1.add_run(' This text is being added to the second paragraph.') # append to pre-existing 2nd paragraph
doc.save('multipleParagraphs.docx')
```

- You can also specify a style when adding a paragraph or a run, for example `doc.add_paragraph('Hello, world!', 'Title')` will add string with style of Title

### add_heading()

- Use `add_heading()` to **add** a **paragraph** with **one of the heading styles** to the document
- specified **heading style** `integer value` can be from `0 - 4`

```python
import docx
doc = docx.Document() # blank document

""" Add headings """
doc.add_heading('Header 0', 0) # add heading with style 0 and txt 'Header 0'
doc.add_heading('Header 1', 1) # add heading with style 1 and txt 'Header 1'
doc.add_heading('Header 2', 2)
doc.add_heading('Header 3', 3)
doc.add_heading('Header 4', 4)
doc.save('headings.docx') # save as a new document
```

### Line and Page Breaks using add_break()

- call `add_break() method` on the `Run object`, you want to have the break appear after a paragraph instead of having to add a whole new paragraph
- If you want to add a page break, use `add_break(docx.enum.text.WD_BREAK.PAGE)`

```python
doc = docx.Document()
doc.add_paragraph('This is on the first page!') # add 1st paragraph
doc.paragraphs[0].runs[0].add_break(docx.enum.text.WD_BREAK.PAGE) # add page after the 1st run of the 1st paragraph
doc.add_paragraph('This is a second page!') # this 2nds paragraph should now appear on a brand new page
doc.save('twoPage.docx') 
```

### add_picture()

- We will eb adding `Zophie.png` from excersise materials

- Use `add_picture()` to **add** a **picture** to the document at the end of the document
- You can specify the **width** and **height** in **either imperial (`Inches`) or metric(`Cm`)** measurements
- the method takes **3 arguments, 2 of which are optional**
  - 1st arg - string of the **file name**, like `Zophie.png`
  - `width=docx.shared.Inches(1)` - optional
  - `height=docx.shared.cm(4)` - optional